<div
  class="py-3 flex flex-0 justify-between items-center bg-white text-3xl font-bold"
>
  <h3>Danh sách phòng và số đề thi</h3>

  <div *ngIf="isEditing; else noEdit">
    <button
      *ngrxLet="isSaving$ as isSaving"
      tuiButton
      (click)="saveChange()"
      [showLoader]="isSaving"
      icon="tuiIconCheckLarge"
      class="mr-2"
    >
      Lưu
    </button>
    <button
      tuiButton
      (click)="cancelEdit()"
      appearance="secondary-destructive"
      icon="tuiIconCloseLarge"
    >
      Hủy
    </button>
  </div>
  <ng-template #noEdit>
    <div>
      <button
        tuiButton
        (click)="toggleEdit(true)"
        icon="tuiIconEditLarge"
        class="mr-2"
      >
        Chỉnh sửa
      </button>
      <button tuiButton icon="tuiIconDownloadLarge">Tải file Excel</button>
    </div>
  </ng-template>
</div>

<tui-scrollbar waIntersectionRoot class="scrollbar" class="flex-1">
  <table
    tuiTable
    *ngIf="form"
    [formGroup]="form"
    [columns]="columns"
    class="w-full"
  >
    <thead>
      <tr tuiThGroup>
        <th tuiTh [sticky]="true">Mã học phần</th>
        <th tuiTh [sticky]="true">Tên học phần</th>
        <th tuiTh [sticky]="true">Hình thức thi</th>
        <th tuiTh [sticky]="true">Ngày thi</th>
        <th tuiTh [sticky]="true">Ca thi</th>
        <th tuiTh [sticky]="true">Phòng thi</th>
        <th tuiTh [sticky]="true">Số thí sinh</th>
        <th tuiTh [sticky]="true">Số đề</th>
      </tr>
    </thead>
    <tbody tuiTbody [data]="data" formArrayName="examsCount">
      <tr *ngFor="let item of data; let i = index" tuiTr>
        <td *tuiCell="'startAt'" tuiTd>
          <div>
            {{ item.startAt | date : "dd/MM/y" }}
          </div>
        </td>
        <td *tuiCell="'examsCount'" tuiTd [class.colored]="isEditing">
          <tui-input-number
            (ngModelChange)="onValueChange(item.id, $event)"
            [formControl]="examsCount(i)"
            [readOnly]="!isEditing"
          ></tui-input-number>
        </td>
      </tr>
    </tbody>
  </table>
</tui-scrollbar>
